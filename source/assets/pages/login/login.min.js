// angular.module('fiona', ['fiona.services']);
angular.module('fiona', ['ngRoute','fiona.services'])
.controller('SignupController', function ($scope, $http, commons) {

    $http.defaults.headers.post['Content-Type']= 'application/json';

    // alert("Invoke: SidebarController");
    $scope.submitted = false;
    $scope.signup = {"name": "admin",  "password":"admin"}


    $scope.signupForm = function() {

        if ($scope.signup_form.$valid) {

            // Submit as normal
            $http.post(commons.getAccountHostname() + "/api/v2/auth/login", $scope.signup).success(function (data, status, headers, config ) {

                alert(status);

                $scope.signup_form.submitted = true;

                if(status!= 200 || data.code !=0 ){
                    $scope.error = true;
                    $scope.message = data.message || "登录失败";
                }
                else {

                    // 保存登录凭证
                    commons.setAuthorization(data.data);

                    $window.location.href = "index.html";
                }

            }).error(function (data, status, headers, config) {
                $scope.message = "登录失败显示错误信息";
            });
        } else {
            $scope.message = "请输入用户名和密码.";

            $scope.signup_form.submitted = true;
        }
    }
});

//
// // 读取目录树
// function  ( $scope, $http, $window, commons) {
//
// };
