angular.module('fiona', ['fiona.services']);

// 读取目录树
function SignupController ( $scope, $http, $window, commons) {

    $http.defaults.headers.post['Content-Type']= 'application/json';

    // alert("Invoke: SidebarController");
    $scope.submitted = false;
    $scope.signup = {"username": "admin",  "password":"admin"}
    $scope.signupForm = function() {

        if ($scope.signup_form.$valid) {

            // Submit as normal
            $http.post("/account/api/v2/auth/login", $scope.signup).success(function (data, status, headers, config ) {

                $scope.signup_form.submitted = true;

                if(data.code !=0 ){
                    $scope.error = true;
                    $scope.message = data.message;
                }
                else {

                    // 保存登录凭证
                    commons.setAuthorization(data.data);

                    $window.location.href = "index.html";
                }

            }).error(function (data, status, headers, config) {
                $scope.message = "登录失败显示错误信息";
            });
        } else {
            $scope.message = "请输入用户名和密码.";

            $scope.signup_form.submitted = true;
        }
    }
};
